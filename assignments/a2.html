<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
<link rel="stylesheet" href="../stylesheets/default.css" type="text/css" media="screen" />
<link rel="shortcut icon" href="../images/favicon.ico" />
<title>COMP 116: Introduction to Computer Security - Assignment 2</title>
</head>

<body>
<div id="main">

<div id = "header">
<h1>Introduction to Computer Security</h1>
<h2>COMP 116, Tufts University Department of Computer Science, Fall 2013</h2>
<h2>Assignment 2: Incident Alarm with PacketFu</h2>
<h2>Due: Thursday, October 3rd</h2>
</div>

<div id="content">
	<h2>Objectives</h2>
	<ol>
		<li>Write a tool to analyze a live stream of network packets for incidents.</li>
		<li>Learn how to parse and dissect network packets programmatically.</li>
		<li>Learn Ruby and regular expressions (for those who do not know already).</li>
	</ol>

	<h2>Overview</h2>
	<p><code>PacketFu</code> is a mid-level packet manipulation library for Ruby written by Tod Beardsley.  That is, you can write programs for reading and writing packets to a network interface or to a libpcap-formatted file.  <code>PacketFu</code> is currently used in the <a href="http://www.rapid7.com/products/metasploit/download.jsp" target="_blank">Metasploit Project</a>.  Read <a href="manipulatingthenetworkwithpacketfu-110314111058-phpapp01.pdf"><span class="title">Manipulating The Network with PacketFu</span> (from Hakin9 Magazine, February 2010)</a> on how to perform ARP spoofing with <code>PacketFu</code>.</p>
	<p>We discussed a number of network scanning techniques during lecture, and you practiced finding sensitive information in PCAP files in the first assignment.  In this assignment, you will apply your knowledge to write a tool to analyze a live stream of network packets for security incidents including scanning, potential web attacks, and information leakage.</p>

	<h2>Instructions</h2>
	<p>Using Ruby and the <code>PacketFu</code> gem, you will write a program named <code>alarm.rb</code> that analyzes a live stream of network packets for the following incidents:</p>
	<ol>
		<li>NULL scan</li>
		<li>Xmas scan</li>
		<li>Nmap scan that is neither a NULL scan or Xmas scan</li>
		<li>Password leakage (recall the first assignment)</li>
		<li>Credit card number leaked in the clear <span class="strss">via website</span></li>
		<li>Basic cross-site scripting (XSS; e.g., <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code>)</li>
	</ol>

	<p>If an incident is detected, alert must be displayed in the format:</p>
	<p><code>#{incident_number}. ALERT: #{attack} is detected from #{source IP address} (#{protocol})!</code></p>
	<p>Examples:</p>
	<ol>
		<li><code>ALERT: Nmap scan is detected from 192.168.1.3 (UDP)!</code></li>
 		<li><code>ALERT: Credit card leaked in the clear from 192.168.1.7 (HTTP)!</code></li>
	</ol>
	<p>Alert message can be displayed multiple times for a source IP address (e.g., from an nmap scan).</p>
	<p>Your program does not need to support reading PCAP files, saving the stream of packets to a PCAP file, or saving a record of detected incidents.</p>

	<h2>Getting Started</h2>
	<ol>
		<li>Make sure that you have installed Ruby on your computer.  I recommend Ruby version 1.9.3.</li>
		<li>Install the <code>pcaprub</code> gem which is required by <code>packetfu</code>: <code>gem install pcaprub</code></li>
		<li>Install the <code>packetfu</code> gem: <code>gem install packetfu</code></li>
		<li>Install the <code>rdoc</code> gem for HTML and command-line documentation for Ruby projects: <code>gem install rdoc</code></li>
		<li>Here is a working live sniffer <code>alarm.rb</code> (change <code>eth0</code> to your interface):
			<pre>
require 'packetfu'

stream = PacketFu::Capture.new(:start => true, :iface => 'eth0', :promisc => true)
stream.show_live()
			</pre>
		</li>
		<li>To run: <code>sudo ruby alarm.rb</code></li>
		<li>Your job is to modify the program to detect incidents.</li>
	</ol>

	<h2>Helpers</h2>
	<ul>
		<li>The payload of a packet is generally in binary format.  To convert a string to binary format in Ruby, you can do: <code>"STRING".each_byte.map { |b| sprintf(" 0x%02X ",b) }.join</code></li>
	</ul>
	
	<h2>RubyGem Documentation</h2>
	<p>While you can go to <a href="http://rubygems.org/" target="_blank">RubyGems.org</a> to get the API documentation for a gem, the documentation may be outdated.  The proper way is to run the gem server on your computer.</p>
	<ol>
		<li>Run <code>gem server</code></li>
		<li>Go to <code>http://127.0.0.1:8808</code> on your web browser</li>
		<li>You will see a list of all the gems installed on your computer.  Go to the rdoc for <code>PacketFu</code></li>
	</ol>
	<h2>References</h2>
	<ul>
		<li><a href="http://tuftsdev.github.io/WebEngineering/lecture_notes/ruby.html">Learning Ruby (my notes)</a></li>
		<li><a href="http://tryruby.org/" target="_blank">TryRuby (interactive tutorial)</a></li>
		<li><a href="http://prezi.com/mw0_9qfb2d6d/packetfu-by-example/" target="_blank">"PacketFu by Example: A PacketFu Primer (presented at SharkFest 2011)" by Tod Beardsley</a></li>
		<li><a href="manipulatingthenetworkwithpacketfu-110314111058-phpapp01.pdf">Manipulating The Network with PacketFu (from Hakin9 Magazine, February 2010)</a></li>
		<li><a href="http://www.sans.org/security-resources/idfaq/snort-detect-credit-card-numbers.php" target="_blank">Detect Clear Text Credit Card Numbers (on SANS.org)</a></li>
	</ul>

	<h2>Submission</h2>
	<p>Push <code>README</code> and your source code <code>alarm.rb</code> to the private repository that I created for you in a folder named <code>alarm</code>.  Say that your private repository is named <code>mchow-comp116</code>, make sure all the files are pushed to <code>mchow-comp116/alarm</code>.</p>
</div>
</div>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-582953-12");
    pageTracker._trackPageview();
  }
  catch(err) {}
</script>

</body>
</html>
