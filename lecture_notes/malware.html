<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
<link rel="stylesheet" href="../stylesheets/default.css" type="text/css" media="screen"/>
<link rel="shortcut icon" href="../images/favicon.ico" />
<title>COMP 116: Introduction to Computer Security</title>
</head>

<body>
<div id="main">
<div id = "header">
<h2>Malware</h2>
</div>

<h3>Overview</h3>
<ul>
<li>Viruses</li>
<li>Worms</li>
<li>Trojan Horses</li>
<li>Backdoors</li>
<li>Rootkits</li>
<li>Botnets</li>
<li>What we will not discuss: symptoms (duh!)</li>
</ul>

<h3>Virus</h3>
<ul>
<li>Think of a biological virus: propagation and piggybacking</li>
<li>A malicious piece of executable code</li>
<li>Propagates by attaching itself to a host file</li>
<li>A virus can be:
<ul>
<li>An executable (i.e., <code>.exe</code> as seen in e-mail attachment)</li>
<li>A script</li>
<li>Document containing macros</li>
<li>A boot sector of a disk partition</li>
</ul>
</li>
<li>Note: when propagating, the virus does not have to be an exact copy of itself!</li>
<li>If you send infected file to someone else and that person executes the file, it will infect the person's system as well</li>
<li>Viruses do not re-infect already infected files</li>
</ul>

<h3>Windowsland vs Unix/Linuxland</h3>
<ul>
<li>Windowsland: Allows third-party applications to run in administrator (a.k.a root mode)</li>
<li>Unix/Linuxland: Code will execute only with the permissions that are assigned to you.  Therefore, less likely to wreck havok</li>
</ul>

<h3>Anatomy of a Virus</h3>
<ul>
<li>Wait on trigger event</li>
<li>Replicate to files and disk</li>
<li>On trigger event, <span class="stress">payload</span> is executed (note: it does not perform propagation)</li>
</ul>

<h3>Worm</h3>
<ul>
<li>Unlike a virus, does not need to attach itself to another file (i.e., self-contained)</li>
<li>Send copies of itself over a network</li>
<li>Another difference: a virus infects a machine while a worm infects a network (e.g., consuming bandwidth)</li>
<li>How does a worm hop from machine to machine on a network?  Using remote commands such as <code>rsh</code>, password cracking, using sockets</li>
</ul>

<h3>Anatomy of a Worm</h3>
<ol>
<li>Morris Worm
<ul>
<li>Named after Robert Tappan Morris, a Ph.D. student at Cornell, now a professor at MIT</li>
<li>Brought down the Internet in November 1988</li>
<li>99 lines of code</li>
<li>The idea: connect to another computer, find and use one of several vulnerabilities (buffer overflow in fingerd, password cracking, etc.) to copy itself to that second computer</li>
<li>Mistake: both the original code and the copy would then repeat these actions in an infinite loop to other computers on the ARPANET</li>
<li>Sendmail bug: At the time when this worm attack took place, it was possible to send a message to the sendmail program running on a remote machine with the debug mode turned on, and with the name of an executable as the recipient of the message. The sendmail program would then try to execute the named Ãžle, the code for execution being the contents of the message</li>
<li>Via rsh and password cracking, when it was able to break into a user account, it would harvest addresses of other remote machines from their '.rhosts' files</li>
<li>Professor Gene Spafford's analysis: <a href="http://spaf.cerias.purdue.edu/tech-reps/823.pdf" target="_blank">http://spaf.cerias.purdue.edu/tech-reps/823.pdf</a></li>
<li>Caused ~$10M - 100M in damages, over 5000 Unix machines affected</li>
<li>First conviction in the US under the 1986 Computer Fraud and Abuse Act</li>
<li>Sentenced to three years of probation, 400 hours of community service, a fine of $10,050, and the costs of his supervision.</li>
</ul>
</li>
<li>Code Red
<ul>
<li>July 2001</li>
<li>Exploited bug in MS IIS to penetrate and spread: <a href="http://www.microsoft.com/technet/security/bulletin/MS01-033.mspx" target="_blank">MS01-033</a></li>
<li>Probes random IPs for systems running IIS (days 1 - 19 of attack)</li>
<li>Defaced websites with the statement "Hacked by Chinese!"</li>
<li>Had trigger time for denial-of-service attack (days 20 - 29 of attack)</li>
<li>Second wave infected 360,000 servers in 14 hours</li>
</ul>
</li>
<li>Slammer
<ul>
<li>January 2003</li>
<li>Random scanning worm</li>
<li>Infected most of the IPv4 Internet in 10 minutes (75,000 hosts infected in one-half hour)</li>
<li>Reference: <a href="http://www.caida.org/publications/papers/2003/sapphire/sapphire.html" target="_blank">http://www.caida.org/publications/papers/2003/sapphire/sapphire.html</a></li>
<li>Exploited a buffer overflow bug: only machines running Microsoft SQL 2000 Servers; supports directory service that allows a client to send in a UDP request to quickly find a database: <a href="http://www.microsoft.com/technet/security/bulletin/MS02-039.mspx" target="_blank">MS02-039</a></li>
</ul>
</li>
</ol>

<h3>Worm Techniques</h3>
<ul>
<li>Scanning; select random IPv4 addresses</li>
<li>Send small packets to reduce suspicion</li>
<li>Connect to vulnerable network services, exploit vulnerability</li>
<li>Perhaps even open up a shell</li>
</ul>

<h3>Trojan Horse</h3>
<ul>
<li>Seemingly useful program that contains code that does harmful things</li>
<li>Can perform both overt and covert action</li>
<li>Payload can be anything (e.g., keylogger, spyware)</li>
</ul>

<h3>Backdoors</h3>
<ul>
<li>Bypasses authentication</li>
<li>Grants attacker access to remote machine</li>
<li>Connecting to a remote machine: used netcat or a malware kit (e.g., MPack)</li>
<li>Example 1: netcat</li>
<li>Example 2: <a href="http://www.ntsecurity.nu/toolbox/tini/" target="_blank">tini.exe</a></li>
</ul>

<h3>General Defense Against Malware</h3>
<ul>
<li>Who do you trust?</li>
<li>Check checksum of software downloads</li>
<li>Secure wipe your system every so often</li>
<li>Scan your system for any suspicious open ports</li>
<li>Advanced: white-listing, behavior blocking</li>
<li>User education</li>
<li>Detect for program changes.  Examples: Bit9 and Tripwire</li>
<li>Patch operating system and applications ASAP</li>
<li>Intrusion detection</li>
</ul>

<h3>About Anti-Virus</h3>
<ul>
<li>Provide a false sense of security</li>
<li>Based on <span class="stress">signature scanning</span>; early viruses had characteristic code patterns known as signatures</li>
<li>Alas, largely reactive; only identifies <span class="stress">what is known</span></li>
<li>Unfortunately now, viruses are polymorphic, stealthy, and encrypted (decryption and key are somewhere else)</li>
<li>Worms can prevents an automatic download of the latest virus signatures from the anti-virus software vendors by altering the DNS software on the infected machine</li>
</ul>

<h3>To Ponder</h3>
<ul>
<li>Can you really get rid of a virus or worm now using anti-virus?</li>
<li>If I'm attacked, can I even restore my system to "normal"?</li>
<li>Can the defenses listed above really work?</li>
<li>How afraid should I be?</li>
</ul>

<h3>References and Acknowledgements</h3>
<ul>
<li><a href="http://www.sans.org/security-resources/malwarefaq/" target="_blank">SANS Malware FAQ</a></li>
<li class="title"><a href="http://www.icir.org/vern/papers/cdc-usenix-sec02/" target="_blank">How to 0wn the Internet in Your Spare Time</a></li>
<li><a href="http://www.virustotal.com/" target="_blank">VirusTotal</a></li>
<li><a href="http://cobweb.ecn.purdue.edu/~kak/compsec/NewLectures/Lecture22.pdf" target="_blank">Professor Avi Kak's lecture (Purdue)</a></li>
</ul>

</div>

<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    var pageTracker = _gat._getTracker("UA-582953-12");
    pageTracker._trackPageview();
  }
  catch(err) {}
</script>

</body>
</html>

